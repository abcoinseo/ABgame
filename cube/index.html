<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Block Ninja</title>
    <style>
        /* style.css content will go here */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1a1a1a; /* Dark background */
            color: #f0f0f0; /* Light text */
            display: flex;
            flex-direction: column; /* Stack canvas and menus */
            align-items: center;
            justify-content: center; /* Center game area */
            min-height: 100vh;
            overflow: hidden; /* Prevent scrollbars from menu popups */
            position: relative; /* For HUD positioning */
        }

        /* Game Canvas */
        #c {
            background-color: #000;
            border: 3px solid #444;
            display: block; /* Remove extra space below */
            max-width: 100%; /* Responsive */
        }

        /* Gameplay HUD */
        .hud {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            padding: 10px;
            font-size: 1.2em;
            z-index: 10;
            pointer-events: none; /* Allow clicks through to canvas by default */
        }

        .hud__score {
            background-color: rgba(0,0,0,0.5);
            padding: 8px 12px;
            border-radius: 5px;
        }

        .score-lbl, .cube-count-lbl {
            margin-bottom: 5px;
        }

        .pause-btn {
            pointer-events: all; /* Make button clickable */
            cursor: pointer;
            background-color: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .pause-btn div { /* Creates the two vertical bars for pause */
            width: 5px;
            height: 20px;
            background-color: white;
            position: relative;
        }
        .pause-btn div::before, .pause-btn div::after {
            content: '';
            position: absolute;
            width: 5px;
            height: 20px;
            background-color: white;
        }
        .pause-btn div::before { left: -8px; }
        .pause-btn div::after { right: -8px; }
        .pause-btn.playing div::before { /* Triangle for play */
            width: 0;
            height: 0;
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent;
            border-left: 18px solid white;
            background-color: transparent;
            left: -10px;
            top: 0px;
        }
        .pause-btn.playing div, .pause-btn.playing div::after {
            display: none;
        }


        .slowmo {
            background-color: rgba(0,0,0,0.5);
            padding: 5px;
            border-radius: 5px;
            width: 100px;
            margin-left: 20px;
        }

        .slowmo__bar {
            height: 10px;
            background-color: #4CAF50; /* Green */
            width: 100%; /* Full by default */
            border-radius: 3px;
            transition: width 0.2s ease-in-out;
        }

        /* Menu System */
        .menus {
            position: fixed; /* Overlay */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85); /* Semi-transparent overlay */
            display: none; /* Hidden by default */
            align-items: center;
            justify-content: center;
            z-index: 100; /* Above everything else */
            padding: 20px;
        }
        .menus.active {
            display: flex; /* Show when active */
        }

        .menu {
            background-color: #2c3e50; /* Dark blue-grey */
            padding: 30px 40px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 25px rgba(0,0,0,0.5);
            display: none; /* Individual menus hidden by default */
            max-width: 400px;
            width: 90%;
        }
        .menu.active {
            display: block; /* Show active menu */
        }

        .menu h1 {
            color: #ecf0f1; /* Light grey */
            margin-bottom: 25px;
            font-size: 2.5em;
        }

        .menu h2 {
            color: #bdc3c7; /* Lighter grey */
            margin-bottom: 10px;
            font-size: 1.5em;
        }

        .menu .final-score-lbl, .menu .high-score-lbl {
            font-size: 1.8em;
            color: #f1c40f; /* Yellow for scores */
            margin-bottom: 20px;
            font-weight: bold;
        }
        .menu .high-score-lbl {
            font-size: 1.2em;
            color: #e67e22; /* Orange for high score */
        }


        .menu button {
            background-color: #3498db; /* Blue */
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
            transition: background-color 0.2s ease, transform 0.1s ease;
            display: block;
            width: 100%;
        }

        .menu button:hover {
            background-color: #2980b9; /* Darker blue */
            transform: translateY(-2px);
        }
        .menu button:active {
            transform: translateY(0px);
        }

        .menu button.play-casual-btn {
            background-color: #2ecc71; /* Green for casual */
        }
        .menu button.play-casual-btn:hover {
            background-color: #27ae60; /* Darker green */
        }

        .credits {
            margin-top: 30px;
            font-size: 0.9em;
            color: #95a5a6; /* Grey */
        }

        .credits a {
            color: #3498db; /* Blue link */
            text-decoration: none;
        }
        .credits a:hover {
            text-decoration: underline;
        }

    </style>
</head>
<body>

    <!-- Game canvas -->
    <canvas id="c"></canvas>

    <!-- Gameplay HUD -->
    <div class="hud">
        <div class="hud__score">
            <div class="score-lbl">Score: 0</div>
            <div class="cube-count-lbl">Cubes: 0</div>
        </div>
        <div class="slowmo">
            <div class="slowmo__bar"></div>
        </div>
        <div class="pause-btn"><div></div></div>
    </div>

    <!-- Menu System -->
    <div class="menus">
        <div class="menu menu--main">
            <h1>Block Ninja</h1>
            <button type="button" class="play-normal-btn">PLAY GAME</button>
            <button type="button" class="play-casual-btn">CASUAL MODE</button>
            <div class="credits">An 8kB game by <a href="https://codepen.io/FRADAR" target="_blank" rel="noopener">FRADAR</a></div>
        </div>
        <div class="menu menu--pause">
            <h1>Paused</h1>
            <button type="button" class="resume-btn">RESUME GAME</button>
            <button type="button" class="menu-btn--pause">MAIN MENU</button>
        </div>
        <div class="menu menu--score">
            <h1>Game Over</h1>
            <h2>Your Score:</h2>
            <div class="final-score-lbl">0</div>
            <div class="high-score-lbl">High Score: 0</div>
            <button type="button" class="play-again-btn">PLAY AGAIN</button>
            <button type="button" class="menu-btn--score">MAIN MENU</button>
        </div>
    </div>

    <script>
        // script.js content will go here
        document.addEventListener('DOMContentLoaded', () => {
            // Canvas and Context
            const canvas = document.getElementById('c');
            const ctx = canvas.getContext('2d');

            // HUD Elements
            const scoreLabel = document.querySelector('.score-lbl');
            const cubeCountLabel = document.querySelector('.cube-count-lbl');
            const slowmoBar = document.querySelector('.slowmo__bar');
            const hudPauseButton = document.querySelector('.hud .pause-btn');

            // Menu Elements
            const menusContainer = document.querySelector('.menus');
            const mainMenu = document.querySelector('.menu--main');
            const pauseMenu = document.querySelector('.menu--pause');
            const scoreMenu = document.querySelector('.menu--score');
            const finalScoreLabel = document.querySelector('.final-score-lbl');
            const highScoreLabel = document.querySelector('.high-score-lbl');

            // Menu Buttons
            const playNormalBtn = document.querySelector('.play-normal-btn');
            const playCasualBtn = document.querySelector('.play-casual-btn');
            const resumeBtn = document.querySelector('.resume-btn');
            const menuBtnPause = document.querySelector('.menu-btn--pause');
            const playAgainBtn = document.querySelector('.play-again-btn');
            const menuBtnScore = document.querySelector('.menu-btn--score');

            // Game State
            let score = 0;
            let cubes = 0;
            let highScore = localStorage.getItem('blockNinjaHighScore') || 0;
            let isPaused = false;
            let isGameOver = false;
            let gameLoopId; // For requestAnimationFrame

            // --- Canvas Setup ---
            function setupCanvas() {
                // Let's make it somewhat responsive, fitting common screen aspect ratios
                const aspectRatio = 4 / 3;
                const maxWidth = 800;
                const maxHeight = 600;

                let newWidth = Math.min(maxWidth, window.innerWidth - 40);
                let newHeight = newWidth / aspectRatio;

                if (newHeight > Math.min(maxHeight, window.innerHeight - 100)) {
                    newHeight = Math.min(maxHeight, window.innerHeight - 100);
                    newWidth = newHeight * aspectRatio;
                }
                
                canvas.width = newWidth;
                canvas.height = newHeight;

                // Initial draw on canvas (placeholder)
                ctx.fillStyle = '#000000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#333333';
                ctx.font = '20px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Game Area - Logic Not Implemented Yet', canvas.width / 2, canvas.height / 2);
            }
            
            window.addEventListener('resize', setupCanvas);


            // --- HUD Update ---
            function updateHUD() {
                scoreLabel.textContent = `Score: ${score}`;
                cubeCountLabel.textContent = `Cubes: ${cubes}`; // Assuming 'cubes' is a game variable
                highScoreLabel.textContent = `High Score: ${highScore}`;
                // Example for slowmo bar:
                // let slowmoPercentage = 50; // Get this from game logic
                // slowmoBar.style.width = `${slowmoPercentage}%`;
            }

            // --- Menu Management ---
            function showMenu(menuToShow) {
                menusContainer.classList.add('active');
                [mainMenu, pauseMenu, scoreMenu].forEach(menu => menu.classList.remove('active'));

                if (menuToShow === 'main') mainMenu.classList.add('active');
                else if (menuToShow === 'pause') pauseMenu.classList.add('active');
                else if (menuToShow === 'score') {
                    finalScoreLabel.textContent = score;
                    highScoreLabel.textContent = `High Score: ${highScore}`;
                    scoreMenu.classList.add('active');
                } else {
                    menusContainer.classList.remove('active'); // Hide all menus
                }
            }

            // --- Game Flow Functions ---
            function startGame(isCasualMode) {
                console.log(`Starting game. Casual: ${isCasualMode}`);
                score = 0;
                cubes = 0; // Reset cubes or other game specific vars
                isPaused = false;
                isGameOver = false;
                hudPauseButton.classList.remove('playing'); // Show pause icon
                updateHUD();
                showMenu(null); // Hide all menus
                // TODO: Initialize actual game elements and logic here
                
                // Start the game loop
                if (gameLoopId) cancelAnimationFrame(gameLoopId);
                gameLoopId = requestAnimationFrame(gameLoop);
            }

            function pauseGame() {
                if (isGameOver) return;
                isPaused = true;
                hudPauseButton.classList.add('playing'); // Show play icon
                showMenu('pause');
                cancelAnimationFrame(gameLoopId); // Stop the game loop
                console.log('Game Paused');
            }

            function resumeGame() {
                isPaused = false;
                hudPauseButton.classList.remove('playing'); // Show pause icon
                showMenu(null);
                // Restart the game loop
                if (gameLoopId) cancelAnimationFrame(gameLoopId);
                gameLoopId = requestAnimationFrame(gameLoop);
                console.log('Game Resumed');
            }

            function S_gameOver() { // Renamed to avoid conflict if you have a global 'gameOver'
                console.log('Game Over');
                isGameOver = true;
                isPaused = true; // Effectively pauses the game
                if (score > highScore) {
                    highScore = score;
                    localStorage.setItem('blockNinjaHighScore', highScore);
                }
                updateHUD(); // Update high score display in score menu
                showMenu('score');
                cancelAnimationFrame(gameLoopId); // Stop the game loop
            }

            function resetToMainMenu() {
                isGameOver = true; // Stop any game logic
                isPaused = true;
                cancelAnimationFrame(gameLoopId);
                // Optionally clear canvas or show a static "main menu" screen on canvas
                ctx.fillStyle = '#000000';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#333333';
                ctx.font = '20px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Main Menu', canvas.width / 2, canvas.height / 2);
                showMenu('main');
            }

            // --- Main Game Loop (Placeholder) ---
            function gameLoop(timestamp) {
                if (isPaused || isGameOver) {
                    return; // Don't update or draw if paused or game over
                }

                // 1. Update game state (placeholder)
                // Example: score++; cubes++; if (score > 100) S_gameOver();

                // 2. Draw game elements (placeholder)
                ctx.fillStyle = '#080808'; // Slightly off-black for active game
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.fillStyle = 'white';
                ctx.font = '24px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(`Playing... Score: ${score}`, canvas.width / 2, canvas.height / 2);
                
                // (Actual game drawing would go here)

                updateHUD(); // Update score, etc. in HUD

                gameLoopId = requestAnimationFrame(gameLoop);
            }

            // --- Event Listeners ---
            playNormalBtn.addEventListener('click', () => startGame(false));
            playCasualBtn.addEventListener('click', () => startGame(true));
            
            hudPauseButton.addEventListener('click', () => {
                if (isPaused && !isGameOver) { // If paused (and not because game is over)
                    resumeGame();
                } else if (!isGameOver) { // If playing
                    pauseGame();
                }
            });

            resumeBtn.addEventListener('click', resumeGame);
            menuBtnPause.addEventListener('click', resetToMainMenu);

            playAgainBtn.addEventListener('click', () => startGame(false)); // Or remember last mode
            menuBtnScore.addEventListener('click', resetToMainMenu);

            // --- Initial Setup ---
            setupCanvas(); // Set initial canvas size
            updateHUD();   // Initialize HUD with scores
            showMenu('main'); // Show main menu on load

            // Example: Simulate game over after 5 seconds for testing
            // setTimeout(() => {
            //    if (!isGameOver && !mainMenu.classList.contains('active') && !pauseMenu.classList.contains('active')) {
            //        score = Math.floor(Math.random() * 1000); // Random score for test
            //        S_gameOver();
            //    }
            // }, 15000); // After 15s if a game is running

        });
    </script>
</body>
</html>
